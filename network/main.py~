from mynet import *
from integrator import *
from scipy.integrate import odeint
import numpy as np
import matplotlib.pyplot as plt

K=4
X0=-1*np.ones((K,2))
dt=0.1
Nsteps=10000
myintegrator=integrator(dt,Nsteps)
mynet=net(K)

#stimulation function
def mysin(x):
	if x>tstart and x<=period+tstart:
		return amp*np.sin(2*np.pi*freq*(x-tstart)**2/(2*period))+I0
	else:
		return I0


amp=0.1 #ampplitude of stimulation
tstart=100.  #begining of stimulation
period=400.
freq=0.4
I0=0. #dc

mynet.stim(mysin)
sol=myintegrator.rk4(mynet.field,X0)


for i in range(0,K,2):
	plt.plot(sol[:,i])
plt.show()
